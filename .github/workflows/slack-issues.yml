name: Notify Slack on Issues
permissions:
  contents: read
on:
  issues:
    types: [opened, reopened]  # New issues AND reopened issues
jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send to Slack
        env:
          ACTION: ${{ github.event.action }}
          ISSUE_NUMBER: ${{ github.event.issue.number }}
          ISSUE_TITLE: ${{ github.event.issue.title }}
          ISSUE_URL: ${{ github.event.issue.html_url }}
          ISSUE_USER: ${{ github.event.issue.user.login }}
        run: |
          if [ "$ACTION" = "opened" ]; then
            EMOJI="ðŸ†•"
            TEXT="New Issue"
          else
            EMOJI="ðŸ”„"
            TEXT="Issue Reopened"
          fi
          
          curl -X POST -H 'Content-type: application/json' \
          --data "{
            \"text\": \"$EMOJI $TEXT: #$ISSUE_NUMBER $ISSUE_TITLE\",
            \"blocks\": [
              {
                \"type\": \"section\",
                \"text\": {
                  \"type\": \"mrkdwn\",
                  \"text\": \"$EMOJI *$TEXT*\n<$ISSUE_URL|#$ISSUE_NUMBER: $ISSUE_TITLE>\nBy: $ISSUE_USER\"
                }
              }
            ]
          }" \
          ${{ secrets.SLACK_WEBHOOK_URL_ISSUES }}
